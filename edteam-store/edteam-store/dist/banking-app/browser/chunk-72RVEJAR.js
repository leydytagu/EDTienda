import{A as ft,B as W,C as gt,F as Ct,H as ht,M as xt,N as z,O as H,P as Q,Q as _t,R as vt,S as J,T as yt,U as It,V as bt,a as k,g as at,h as T,i as Y,j as B,k as R,l as ct,n as st,p as dt,r as lt,u as mt,w as pt,y as ut,z as F}from"./chunk-J35QIWRH.js";import{Ab as o,Bb as n,Cb as it,Fb as L,Ib as x,Jc as A,Kb as m,Mc as E,Nb as rt,Nc as ot,Tb as s,Ua as tt,Ub as w,Vb as f,Wb as nt,Xa as d,Xb as U,Ya as l,Yb as $,Zb as q,aa as I,ac as _,ba as V,bc as v,fa as b,ga as Z,ib as et,la as S,ma as N,ob as p,qb as u,ta as C,ua as h,uc as X,vb as D,wb as M,yb as O,zb as P}from"./chunk-IDCTCBMT.js";var Mt=(()=>{let t=class t{constructor(e){this.http=e,this.baseUrl=B.apiUrl}getProducts(){let e=`${this.baseUrl}/products`;return this.http.get(e)}getCategories(){let e=`${this.baseUrl}/categories`;return this.http.get(e)}};t.\u0275fac=function(i){return new(i||t)(b(k))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();var G=(()=>{let t=class t{constructor(e){this.http=e,this.baseUrl=B.apiUrl,this.cartItems=et([]),this.items=X(()=>this.cartItems()),this.cartItemCount=X(()=>this.cartItems().reduce((c,g)=>c+g.quantity,0));let i=localStorage.getItem("cartItems");i&&this.cartItems.set(JSON.parse(i))}addToCart(e){let i=this.cartItems().findIndex(c=>c.productId===e.id);if(i>-1)this.cartItems()[i].quantity+=1;else{let c={productId:e.id,quantity:1,product:e};this.cartItems().push(c)}this.updateCart()}updateQuantity(e,i){let c=this.cartItems().findIndex(g=>g.productId===e);c>-1&&(this.cartItems()[c].quantity=i,this.updateCart())}removeFromCart(e){this.cartItems.update(i=>i.filter(c=>c.productId!==e)),this.updateCart()}clearCart(){this.cartItems.set([]),this.updateCart()}updateCart(){localStorage.setItem("cartItems",JSON.stringify(this.cartItems())),this.cartItems.set(JSON.parse(localStorage.getItem("cartItems")||"[]"))}findProductById(e){let i=`${this.baseUrl}/products/${e}`;return this.http.get(i)}};t.\u0275fac=function(i){return new(i||t)(b(k))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();function Vt(r,t){if(r&1&&(o(0,"mat-option",8),s(1),n()),r&2){let a=t.$implicit;u("value",a.id),d(),w(a.name)}}function Nt(r,t){if(r&1){let a=L();o(0,"div",11)(1,"mat-card",12)(2,"mat-card-header")(3,"mat-card-title"),s(4),n()(),it(5,"img",13),o(6,"mat-card-content")(7,"p"),s(8),n(),o(9,"p"),s(10),_(11,"currency"),n()(),o(12,"mat-card-actions",14)(13,"button",15),x("click",function(){let i=C(a).$implicit,c=m();return h(c.addToCart(i))}),s(14,"A\xF1adir al Carrito"),n()()()()}if(r&2){let a=t.$implicit;d(4),w(a.name),d(),rt("alt","Imagen de ",a.name,""),u("src",a.image,tt),d(3),w(a.description),d(2),f("Precio: ",v(11,6,a.price,"USD","symbol","1.2-2"),"")}}function Ut(r,t){r&1&&(o(0,"p"),s(1,"No hay productos disponibles."),n())}var kt=(()=>{let t=class t{constructor(e,i){this.productService=e,this.cartService=i,this.products=[],this.filteredProducts=[],this.categories=[],this.selectedCategory=null,this.cartItemCount=0}ngOnInit(){this.loadProducts(),this.loadCategories()}get countInCart(){return this.cartService.cartItemCount()}loadProducts(){this.productService.getProducts().subscribe({next:e=>{this.products=e,this.filteredProducts=e},error:e=>{console.error("Error fetching products",e)}})}loadCategories(){this.productService.getCategories().subscribe({next:e=>{this.categories=e},error:e=>{console.error("Error fetching categories",e)}})}filterByCategory(){this.selectedCategory?this.filteredProducts=this.products.filter(e=>e.categoryId===this.selectedCategory):this.filteredProducts=this.products}addToCart(e){this.cartService.addToCart(e)}};t.\u0275fac=function(i){return new(i||t)(l(Mt),l(G))},t.\u0275cmp=S({type:t,selectors:[["app-product-catalog"]],decls:20,vars:5,consts:[[1,"container"],[1,"top-bar"],[1,"cart-badge"],["mat-icon-button","","routerLink","/product/cart","matBadgeColor","warn","matBadgePosition","above after",3,"matBadge"],["mat-button","","color","primary","routerLink","/product/order-list",1,"view-orders-button"],[1,"category-filter"],["appearance","fill"],[3,"valueChange","selectionChange","value"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],[1,"card-container"],[1,"product-card"],[1,"example-card"],["mat-card-image","",3,"src","alt"],[1,"card-actions"],["mat-raised-button","","color","primary",3,"click"]],template:function(i,c){i&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3)(4,"mat-icon"),s(5,"shopping_cart"),n()()(),o(6,"button",4),s(7," Ver Mis Pedidos "),n()(),o(8,"div",5)(9,"mat-form-field",6)(10,"mat-label"),s(11,"Filtrar por Categor\xEDa"),n(),o(12,"mat-select",7),q("valueChange",function(j){return $(c.selectedCategory,j)||(c.selectedCategory=j),j}),x("selectionChange",function(){return c.filterByCategory()}),o(13,"mat-option",8),s(14,"Todas las Categor\xEDas"),n(),p(15,Vt,2,2,"mat-option",9),n()()(),o(16,"div",10),O(17,Nt,15,11,"div",11,M,!1,Ut,2,0,"p"),n()()),i&2&&(d(3),u("matBadge",c.countInCart),d(9),U("value",c.selectedCategory),d(),u("value",null),d(2),u("ngForOf",c.categories),d(2),P(c.filteredProducts))},dependencies:[A,T,Ct,gt,F,ft,ht,z,vt,Q,J,yt,H,xt,ut,It,E],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.top-bar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.cart-badge[_ngcontent-%COMP%]{margin-right:10px}.category-filter[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.card-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:20px}.product-card[_ngcontent-%COMP%]{width:100%;max-width:300px}.example-card[_ngcontent-%COMP%]{width:100%}.card-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.view-orders-button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase;background-color:#1976d2;color:#fff;border:none;cursor:pointer;transition:background-color .3s}.view-orders-button[_ngcontent-%COMP%]:hover{background-color:#0d47a1}.view-orders-button[_ngcontent-%COMP%]:focus{outline:none;background-color:#0d47a1}"]});let r=t;return r})();var K=(()=>{let t=class t{constructor(e){this.http=e,this.baseUrl=B.apiUrl}createOrder(e){let i=`${this.baseUrl}/orders`;return this.http.post(i,e)}getOrdersByCustomer(e){let i=`${this.baseUrl}/ordersByCustomer/${e}`;return this.http.get(i)}};t.\u0275fac=function(i){return new(i||t)(b(k))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let r=t;return r})();function qt(r,t){if(r&1){let a=L();o(0,"div",3)(1,"mat-card",9)(2,"mat-card-header")(3,"mat-card-title"),s(4),n(),o(5,"mat-card-subtitle"),s(6),_(7,"currency"),n()(),o(8,"mat-card-content")(9,"p"),s(10,"Cantidad: "),o(11,"input",10),q("ngModelChange",function(i){let c=C(a).$implicit;return $(c.quantity,i)||(c.quantity=i),h(i)}),x("change",function(){let i=C(a).$implicit,c=m(2);return h(c.updateQuantity(i.productId,i.quantity))}),n()(),o(12,"button",11),x("click",function(){let i=C(a).$implicit,c=m(2);return h(c.removeItem(i.productId))}),s(13,"Eliminar"),n()()()()}if(r&2){let a=t.$implicit;d(4),w(a.product==null?null:a.product.name),d(2),f("Precio: ",v(7,3,a.product==null?null:a.product.price,"USD","symbol","1.2-2"),""),d(5),U("ngModel",a.quantity)}}function At(r,t){r&1&&(o(0,"p",4),s(1,"No hay productos en el carrito."),n())}function Rt(r,t){if(r&1){let a=L();o(0,"div",0)(1,"h1",1),s(2,"Carrito de Compras"),n(),o(3,"div",2),O(4,qt,14,8,"div",3,M,!1,At,2,0,"p",4),n(),o(7,"div",5)(8,"h3"),s(9),_(10,"currency"),n()(),o(11,"div",6)(12,"button",7),x("click",function(){C(a);let i=m();return h(i.placeOrder())}),s(13,"Generar Pedido"),n(),o(14,"button",8),s(15,"Continuar Comprando"),n()()()}if(r&2){let a=m();d(4),P(a.itemsInCart),d(5),f("Total: ",v(10,2,a.totalAmount,"USD","symbol","1.2-2"),"")}}function Wt(r,t){r&1&&(o(0,"div",0)(1,"p",4),s(2,"No hay productos en el carrito."),n(),o(3,"div",6)(4,"button",8),s(5,"Ir al Cat\xE1logo"),n()()())}var Bt=(()=>{let t=class t{constructor(e,i,c,g,j){this.cartService=e,this.orderService=i,this.router=c,this.snackBar=g,this.authService=j,this.cartItems=[],this.totalAmount=0,this.loginResponse=this.authService.getLoginResponse()}ngOnInit(){this.calculateTotal()}get itemsInCart(){return this.cartService.items()}updateQuantity(e,i){this.cartService.updateQuantity(e,i),this.calculateTotal()}removeItem(e){this.cartService.removeFromCart(e),this.calculateTotal()}calculateTotal(){this.totalAmount=0,this.itemsInCart.forEach(e=>{this.cartService.findProductById(e.productId).subscribe({next:i=>{this.totalAmount+=e.quantity*i.price},error:()=>{this.showSnackBar("Error al obtener el producto.")}})})}placeOrder(){let e={customerId:this.loginResponse.user.id,date:new Date().toISOString().split("T")[0],cartItems:this.itemsInCart.map(i=>({productId:i.productId,quantity:i.quantity})),total:this.totalAmount};this.orderService.createOrder(e).subscribe({next:()=>{this.showSnackBar("Pedido realizado con \xE9xito"),this.cartService.clearCart(),this.router.navigate(["/orders"])},error:()=>{this.showSnackBar("Error en el registro. Por favor, intenta de nuevo.")}})}showSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:3e3})}};t.\u0275fac=function(i){return new(i||t)(l(G),l(K),l(at),l(W),l(R))},t.\u0275cmp=S({type:t,selectors:[["app-cart-item-detail"]],decls:2,vars:1,consts:[[1,"container","py-5"],[1,"fw-bold","text-center"],[1,"card-container"],[1,"cart-item-card"],[1,"text-center"],[1,"total-container"],[1,"actions-container"],["mat-raised-button","","color","primary",3,"click"],["mat-button","","color","accent","routerLink","/product/catalog"],[1,"example-card"],["type","number","min","1",3,"ngModelChange","change","ngModel"],["mat-button","","color","warn",3,"click"]],template:function(i,c){i&1&&p(0,Rt,16,7,"div",0)(1,Wt,6,0),i&2&&D(0,c.itemsInCart.length>0?0:1)},dependencies:[T,F,z,Q,J,_t,H,ct,lt,st,mt,dt,E],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.cart-item-card[_ngcontent-%COMP%]{margin-bottom:20px}.example-card[_ngcontent-%COMP%]{width:100%}.mat-card-header[_ngcontent-%COMP%], .mat-card-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.mat-card-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}.actions-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#1976d2;color:#fff}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#f50057;color:#fff}.actions-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:.8}"]});let r=t;return r})();function zt(r,t){if(r&1&&(o(0,"li")(1,"p"),s(2),n()()),r&2){let a=t.$implicit;d(2),nt("",a.productName," - Cantidad: ",a.quantity,"")}}function Ht(r,t){if(r&1&&(o(0,"div")(1,"p")(2,"strong"),s(3,"Total:"),n(),s(4),_(5,"currency"),n()()),r&2){let a=m().$implicit;d(4),f(" ",v(5,1,a.total,"USD","symbol","1.2-2"),"")}}function Qt(r,t){if(r&1&&(o(0,"div",5)(1,"div",6)(2,"p")(3,"strong"),s(4,"Fecha:"),n(),s(5),n()(),o(6,"div",7)(7,"h4"),s(8,"\xCDtems del Carrito:"),n(),o(9,"ul"),p(10,zt,3,2,"li",8),n()(),p(11,Ht,6,6,"div"),n()),r&2){let a=t.$implicit;d(5),f(" ",a.date,""),d(5),u("ngForOf",a.cartItems),d(),D(11,a.total?11:-1)}}function Jt(r,t){if(r&1&&(o(0,"div",4),O(1,Qt,12,3,"div",5,M),n()),r&2){let a=m();d(),P(a.orders)}}function Gt(r,t){r&1&&(o(0,"p",9),s(1,"No hay pedidos disponibles."),n())}var Ft=(()=>{let t=class t{constructor(e,i){this.ordersService=e,this.snackBar=i,this.orders=[],this.authService=Z(R),this.loginResponse=this.authService.getLoginResponse()}ngOnInit(){this.loadOrders()}loadOrders(){this.ordersService.getOrdersByCustomer(this.loginResponse.user.id).subscribe({next:e=>{this.orders=e},error:()=>{this.showSnackBar("Error fetching orders")}})}showSnackBar(e){this.snackBar.open(e,"Cerrar",{duration:3e3})}};t.\u0275fac=function(i){return new(i||t)(l(K),l(W))},t.\u0275cmp=S({type:t,selectors:[["app-order-list"]],decls:8,vars:1,consts:[[1,"container"],[1,"fw-bold","text-center"],[1,"top-bar"],["mat-raised-button","","color","primary","routerLink","/product/catalog",1,"view-catalog-button"],[1,"order-grid"],[1,"order-card"],[1,"order-info"],[1,"cart-items"],[4,"ngFor","ngForOf"],[1,"text-center"]],template:function(i,c){i&1&&(o(0,"div",0)(1,"h1",1),s(2,"Lista de Pedidos"),n(),o(3,"div",2)(4,"button",3),s(5," Ver Cat\xE1logo "),n()(),p(6,Jt,3,0,"div",4)(7,Gt,2,0),n()),i&2&&(d(6),D(6,c.orders.length>0?6:7))},dependencies:[A,T,F,E],styles:[".container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px}.top-bar[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:20px}.view-catalog-button[_ngcontent-%COMP%], .view-orders-button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;border-radius:4px;text-transform:uppercase}.view-catalog-button[_ngcontent-%COMP%]:hover, .view-orders-button[_ngcontent-%COMP%]:hover{background-color:#1976d2;color:#fff}.view-catalog-button[_ngcontent-%COMP%]:focus, .view-orders-button[_ngcontent-%COMP%]:focus{outline:none}.order-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.order-card[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px}.order-info[_ngcontent-%COMP%], .cart-items[_ngcontent-%COMP%]{margin-bottom:10px}.text-center[_ngcontent-%COMP%]{text-align:center}"]});let r=t;return r})();var Kt=[{path:"catalog",component:kt},{path:"cart",component:Bt},{path:"order-list",component:Ft}],jt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=N({type:t}),t.\u0275inj=V({imports:[Y.forChild(Kt),Y]});let r=t;return r})();var ke=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=N({type:t}),t.\u0275inj=V({imports:[ot,jt,bt,pt]});let r=t;return r})();export{ke as ProductModule};
